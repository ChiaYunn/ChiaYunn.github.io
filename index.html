<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>åœ‹å­—ç­†ç•«ç·´ç¿’ç³»çµ±</title>
  <style>
    body {
      background-color: #f7f7f7;
      font-family: sans-serif;
      text-align: center;
      padding: 30px;
    }
    #hanzi-container {
      width: 300px;
      height: 300px;
      background-color: #ddd;
      margin: 20px auto;
      border: 2px solid #aaa;
    }
    #grade-select {
      font-size: 18px;
      margin-bottom: 10px;
    }
    #question {
      font-size: 28px;
      margin-top: 20px;
    }
    #message {
      margin-top: 20px;
      font-size: 20px;
      color: red;
    }
    button {
      font-size: 18px;
      padding: 5px 15px;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>åœ‹å­—ç­†ç•«é †åºç·´ç¿’</h1>

  <label for="grade-select">é¸æ“‡å¹´ç´šï¼š</label>
  <select id="grade-select">
    <option value="1">ä¸€å¹´ç´šï¼¿ä¸Šå­¸æœŸ</option>
    <option value="2">ä¸€å¹´ç´šï¼¿ä¸‹å­¸æœŸ</option>
    <option value="3">äºŒå¹´ç´šï¼¿ä¸Šå­¸æœŸ</option>
    <option value="4">äºŒå¹´ç´šï¼¿ä¸‹å­¸æœŸ</option>
    <option value="5">ä¸‰å¹´ç´šï¼¿ä¸Šå­¸æœŸ</option>
    <option value="6">ä¸‰å¹´ç´šï¼¿ä¸‹å­¸æœŸ</option>
    <option value="7">å››å¹´ç´šï¼¿ä¸Šå­¸æœŸ</option>
    <option value="8">å››å¹´ç´šï¼¿ä¸‹å­¸æœŸ</option>
    <option value="9">äº”å¹´ç´šï¼¿ä¸Šå­¸æœŸ</option>
    <option value="10">äº”å¹´ç´šï¼¿ä¸‹å­¸æœŸ</option>
    <option value="11">å…­å¹´ç´šï¼¿ä¸Šå­¸æœŸ</option>
    <option value="12">å…­å¹´ç´šï¼¿ä¸‹å­¸æœŸ</option>
  </select>

  <button onclick="loadRandomCharacter()">ä¸‹ä¸€é¡Œ</button>
  <div id="counter">âœ”ï¸ ä»Šå¤©å¯«å°ï¼š0 æ¬¡</div>
  <button onclick="replayAudio()">ğŸ”Š é‡æ’­èªéŸ³</button>


  <div id="question"></div>
  <div id="hanzi-container"></div>
  <div id="message"></div>

  <script src="https://unpkg.com/hanzi-writer@2.0.2/dist/hanzi-writer.min.js"></script>
  <script>
    const hanziData = {
      1: [
    { word: "ä¸€", zhuyin: "ã„§" },
    { word: "äºŒ", zhuyin: "ã„¦Ë‹" },
    { word: "ä¸‰", zhuyin: "ã„™ã„¢" },
    { word: "å››", zhuyin: "ã„™Ë‹" },
    { word: "äº”", zhuyin: "ã„¨Ë‡" },
    { word: "å…­", zhuyin: "ã„Œã„§ã„¡Ë‹" },
    { word: "ä¸ƒ", zhuyin: "ã„‘ã„§" },
    { word: "å…«", zhuyin: "ã„…ã„š" },
    { word: "ä¹", zhuyin: "ã„ã„§ã„¡Ë‡" },
    { word: "å", zhuyin: "ã„•ËŠ" },
    { word: "æ—¥", zhuyin: "ã„–Ë‹" },
    { word: "æœˆ", zhuyin: "ã„©ã„Ë‹" },
    { word: "å±±", zhuyin: "ã„•ã„¢" },
    { word: "æœ¨", zhuyin: "ã„‡ã„¨Ë‹" },
    { word: "æ°´", zhuyin: "ã„•ã„¨ã„ŸË‡" },
    { word: "äºº", zhuyin: "ã„–ã„£ËŠ" },
    { word: "æ‰‹", zhuyin: "ã„•ã„¡Ë‡" },
    { word: "é–€", zhuyin: "ã„‡ã„£ËŠ" },
    { word: "å°", zhuyin: "ã„’ã„§ã„ Ë‡" },
    { word: "ä¸Š", zhuyin: "ã„•ã„¤Ë‹" },
    { word: "èµ°", zhuyin: "ã„—ã„¡Ë‡" },
    { word: "å·¦", zhuyin: "ã„—ã„¨ã„›Ë‡" },
    { word: "å³", zhuyin: "ã„§ã„¡Ë‹" },
    { word: "å‘", zhuyin: "ã„’ã„§ã„¤Ë‹" },
    { word: "é­š", zhuyin: "ã„©ËŠ" },
    { word: "ä¹Ÿ", zhuyin: "ã„§ã„Ë‡" },
    { word: "ä¾†", zhuyin: "ã„Œã„ËŠ" },
    { word: "åŠ ", zhuyin: "ã„ã„§ã„š" },
    { word: "èˆ¹", zhuyin: "ã„”ã„¨ã„¢ËŠ" },
    { word: "å‰", zhuyin: "ã„‘ã„§ã„¢ËŠ" },
    { word: "æ²¹", zhuyin: "ã„§ã„¡ËŠ" },
    { word: "é–‹", zhuyin: "ã„ã„" },
    { word: "å‡º", zhuyin: "ã„”ã„¨" },
    { word: "æ‹›", zhuyin: "ã„“ã„ " },
    { word: "è»Š", zhuyin: "ã„”ã„œ" },
    { word: "å­", zhuyin: "ã„—Ë‡" },
    { word: "èŠ±", zhuyin: "ã„ã„¨ã„š" },
    { word: "åœ°", zhuyin: "ã„‰ã„§Ë‹" },
    { word: "åœ¨", zhuyin: "ã„—ã„Ë‹" },
    { word: "ç¬‘", zhuyin: "ã„’ã„§ã„ Ë‹" },
    { word: "å°", zhuyin: "ã„§ã„£Ë‹" },
    { word: "å¼µ", zhuyin: "ã„“ã„¤" },
    { word: "è‡‰", zhuyin: "ã„Œã„§ã„¢Ë‡" },
    { word: "æ³¡", zhuyin: "ã„†ã„ Ë‹" },
    { word: "ç©", zhuyin: "ã„¨ã„¢ËŠ" },
    { word: "å¤§", zhuyin: "ã„‰ã„šË‹" },
    { word: "èµ·", zhuyin: "ã„‘ã„§Ë‡" },
    { word: "å¥½", zhuyin: "ã„ã„ Ë‡" },
    { word: "å¤š", zhuyin: "ã„‰ã„¨ã„›" },
    { word: "æˆ‘", zhuyin: "ã„¨ã„›Ë‡" },
    { word: "çš„", zhuyin: "ã„‰ã„œË™" },
    { word: "æœµ", zhuyin: "ã„‰ã„¨ã„›Ë‡" },
    { word: "ä½ ", zhuyin: "ã„‹ã„§Ë‡" },
    { word: "æŠ±", zhuyin: "ã„…ã„ Ë‹" },
    { word: "å¹", zhuyin: "ã„”ã„¨ã„Ÿ" },
    { word: "åƒ", zhuyin: "ã„’ã„§ã„¤Ë‹" },
    { word: "çˆ¸", zhuyin: "ã„…ã„šË‹" },
    { word: "åˆ°", zhuyin: "ã„‰ã„ Ë‹" },
    { word: "é’", zhuyin: "ã„‘ã„§ã„¥" },
    { word: "å«", zhuyin: "ã„ã„§ã„ Ë‹" },
    { word: "ä¸‹", zhuyin: "ã„’ã„§ã„šË‹" },
    { word: "é‚£", zhuyin: "ã„‹ã„šË‹" },
    { word: "å’Œ", zhuyin: "ã„ã„œËŠ" },
    { word: "è¦", zhuyin: "ã„§ã„ Ë‹" },
    { word: "ä»–", zhuyin: "ã„Šã„š" },
    { word: "æœ‹", zhuyin: "ã„†ã„¥ËŠ" },
    { word: "å‹", zhuyin: "ã„§ã„¡Ë‡" },
    { word: "è·Ÿ", zhuyin: "ã„ã„£" },
    { word: "é ­", zhuyin: "ã„Šã„¡ËŠ" },
    { word: "æƒ³", zhuyin: "ã„’ã„§ã„¤Ë‡" },
    { word: "åš", zhuyin: "ã„—ã„¨ã„›Ë‹" },
    { word: "å¤–", zhuyin: "ã„¨ã„Ë‹" },
    { word: "ä½", zhuyin: "ã„“ã„¨Ë‹" },
    { word: "å€‹", zhuyin: "ã„ã„œË‹" },
    { word: "å€‘", zhuyin: "ã„‡ã„£Ë™" },
    { word: "é€™", zhuyin: "ã„“ã„œË‹" },
    { word: "è£¡", zhuyin: "ã„Œã„§Ë‡" },
    { word: "æœ‰", zhuyin: "ã„§ã„¡Ë‡" },
    { word: "æ²’", zhuyin: "ã„‡ã„ŸËŠ" },
    { word: "æ˜¯", zhuyin: "ã„•Ë‹" },
    { word: "ä»€", zhuyin: "ã„•ã„£ËŠ" },
    { word: "éº¼", zhuyin: "Ë™ã„‡ã„œ" },
    { word: "æ˜Ÿ", zhuyin: "ã„’ã„§ã„¥" },
    { word: "å“ª", zhuyin: "ã„‹ã„šË‡" },
    { word: "çƒ", zhuyin: "ã„‘ã„§ã„¡ËŠ" },
    { word: "å®¶", zhuyin: "ã„ã„§ã„š" },
    { word: "æ²³", zhuyin: "ã„ã„œËŠ" },
    { word: "é‡‘", zhuyin: "ã„ã„§ã„£" },
    { word: "èªª", zhuyin: "ã„•ã„¨ã„›" },
    { word: "å¥", zhuyin: "ã„ã„©Ë‹" },
    { word: "è©±", zhuyin: "ã„ã„¨ã„šË‹" },
    { word: "å…©", zhuyin: "ã„Œã„§ã„¤Ë‡" },
    { word: "éƒ½", zhuyin: "ã„‰ã„¡" },
    { word: "æ‚„", zhuyin: "ã„‘ã„§ã„ Ë‡" },
    { word: "å°¾", zhuyin: "ã„¨ã„ŸË‡" },
    { word: "å·´", zhuyin: "ã„…ã„š" },
    { word: "æ»¿", zhuyin: "ã„‡ã„¢Ë‡" },
    { word: "ç´…", zhuyin: "ã„ã„¨ã„¥ËŠ" },
    { word: "å", zhuyin: "ã„Šã„¨Ë‡" },
    { word: "ç¼¸", zhuyin: "ã„ã„¤" },
    { word: "æ–", zhuyin: "ã„§ã„ ËŠ" },
    { word: "æ˜¥", zhuyin: "ã„”ã„¨ã„£" },
    { word: "è²¼", zhuyin: "ã„Šã„§ã„" },
    { word: "å‘¢", zhuyin: "Ë™ã„‹ã„œ" },
    { word: "äº†", zhuyin: "Ë™ã„Œã„œ" },
    { word: "è«‹", zhuyin: "ã„‘ã„§ã„¥Ë‡" },
    { word: "å¤©", zhuyin: "ã„Šã„§ã„¢" },
    { word: "å®¶", zhuyin: "ã„ã„§ã„š" },
    { word: "æŠŠ", zhuyin: "ã„…ã„šË‡" },
    { word: "ä¸", zhuyin: "ã„…ã„¨Ë‹" },
    { word: "æˆ¿", zhuyin: "ã„ˆã„¤ËŠ" },
    { word: "ç¦", zhuyin: "ã„ˆã„¨ËŠ" },
    { word: "æµ", zhuyin: "ã„Œã„§ã„¡ËŠ" },
    { word: "å¹¸", zhuyin: "ã„’ã„§ã„¥Ë‹" }
    
      ],
      2: [
        
      ],
      // æ“´å……æ›´å¤šå¹´ç´šçš„å­—
    };

let writer = null;
  let currentWord = "";
  let currentUtter = null;

  function initCounter() {
    const today = new Date().toDateString();
    const savedDate = localStorage.getItem('counterDate');
    if (savedDate !== today) {
      localStorage.setItem('correctCount', '0');
      localStorage.setItem('counterDate', today);
    }
    updateCounterDisplay();
  }

  function incrementCounter() {
    let count = parseInt(localStorage.getItem('correctCount') || '0', 10);
    count += 1;
    localStorage.setItem('correctCount', count.toString());
    updateCounterDisplay();
  }

  function updateCounterDisplay() {
    const count = localStorage.getItem('correctCount') || '0';
    document.getElementById('counter').innerText = `âœ”ï¸ ä»Šå¤©å¯«å°ï¼š${count} æ¬¡`;
  }

  function replayAudio() {
    if (currentUtter) {
      speechSynthesis.cancel();
      speechSynthesis.speak(currentUtter);
    }
  }

  function startQuiz() {
    writer.quiz({
      onComplete: () => {
        document.getElementById('message').innerText = 'å¯«å°äº†ï¼å¥½æ£’ï¼';
        incrementCounter();
      },
      onMistake: () => {
        const msg = document.getElementById('message');
        msg.innerText = 'ç­†é †éŒ¯äº†ï¼Œè«‹é‡æ–°ä¾†éï½';

        // çŸ­æš«æ¸…é™¤éŒ¯èª¤æç¤º
        setTimeout(() => {
          msg.innerText = '';
        }, 500);

        startQuiz(); // å†æ¬¡å•Ÿå‹• quizï¼ŒåŒ…å«æ­£ç¢º onComplete
      }
    });
  }

  function loadRandomCharacter() {
    const grade = document.getElementById('grade-select').value;
    const chars = hanziData[grade];

    if (!chars || chars.length === 0) {
      alert("æ­¤å¹´ç´šå°šæœªæœ‰å­—ã€‚");
      return;
    }

    const randomChar = chars[Math.floor(Math.random() * chars.length)];
    const { word, zhuyin } = randomChar;
    currentWord = word;

    document.getElementById('question').innerText = `è«‹å¯«ï¼šã€Œ${word}ã€  æ³¨éŸ³ï¼š${zhuyin}`;
    document.getElementById('message').innerText = '';

    const container = document.getElementById('hanzi-container');
    container.innerHTML = ''; // æ¸…é™¤ä¸Šä¸€é¡Œ SVG

    writer = HanziWriter.create(container, word, {
      width: 300,
      height: 300,
      padding: 10,
      showOutline: true,
      showCharacter: false,
      strokeColor: '#000',
      radicalColor: '#000',
      drawingColor: '#000'
    });

    startQuiz();

    // è‡ªå‹•æ’­æ”¾èªéŸ³
    currentUtter = new SpeechSynthesisUtterance(word);
    currentUtter.lang = 'zh-TW';
    currentUtter.rate = 0.8;
    speechSynthesis.cancel();
    speechSynthesis.speak(currentUtter);
  }

  // é é¢åˆå§‹åŒ–
  window.onload = () => {
    initCounter();
    loadRandomCharacter();
  };
</script>
</body>
</html>
