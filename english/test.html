<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>è‹±æ–‡å–®å­—æ¸¬é©—</title>
<style>
body {
    font-family: "Microsoft JhengHei", sans-serif;
    text-align: center;
    padding: 40px;
    background: #fff0f6;
}
h1 { color:#ff69b4; }
button { 
    margin:5px; padding:12px 24px; font-size:1.2rem; border-radius:10px; border:none; cursor:pointer;
    background:#ff9bd0; color:white; transition:0.2s;
}
button:hover { background:#ff6fa8; }
.option {
    margin:5px; padding:10px 15px; display:inline-block; border-radius:8px; cursor:pointer;
    border:1px solid #ffb6d6; transition:0.2s;
}
.option:hover { background:#ffe0f0; }
.correct { background:#90ee90; }
.wrong { background:#ff7f7f; }
#quiz-box { display:none; margin-top:20px; }
#start-buttons { display:none; margin-top:20px; }
#role-select, #course-select { margin-top:20px; }
.course-btn.selected { background:#ff6fa8; }
.container { max-width:600px; margin:0 auto; }
</style>
</head>
<body>
<div class="container">
<h1>è‹±æ–‡å–®å­—æ¸¬é©— ğŸ€</h1>

<!-- é¸å°å­© -->
<div id="role-select">
    <p>è«‹é¸å°å­©ï¼š</p>
    <button onclick="chooseKid('Ray', this)">Ray</button>
    <button onclick="chooseKid('Elsa', this)">Elsa</button>
    <button onclick="chooseKid('Mia', this)">Mia</button>
</div>

<!-- é¸èª²ç¨‹ -->
<div id="course-select" style="display:none; text-align:center; margin-top:20px;">
    <p><b>è«‹é¸èª²ç¨‹ï¼ˆç¬¬ä¸€å†Šï½ç¬¬ä¹å†Šï¼‰ï¼š</b></p>
    <div id="course-buttons">
        <button class="course-btn" data-lesson="1" onclick="toggleCourse(this)">ç¬¬1å†Š</button>
        <button class="course-btn" data-lesson="2" onclick="toggleCourse(this)">ç¬¬2å†Š</button>
        <button class="course-btn" data-lesson="3" onclick="toggleCourse(this)">ç¬¬3å†Š</button>
        <button class="course-btn" data-lesson="4" onclick="toggleCourse(this)">ç¬¬4å†Š</button>
        <button class="course-btn" data-lesson="5" onclick="toggleCourse(this)">ç¬¬5å†Š</button>
        <button class="course-btn" data-lesson="6" onclick="toggleCourse(this)">ç¬¬6å†Š</button>
        <button class="course-btn" data-lesson="7" onclick="toggleCourse(this)">ç¬¬7å†Š</button>
        <button class="course-btn" data-lesson="8" onclick="toggleCourse(this)">ç¬¬8å†Š</button>
        <button class="course-btn" data-lesson="9" onclick="toggleCourse(this)">ç¬¬9å†Š</button>
    </div>
    <p>
        <button onclick="selectAllCourses()">å…¨é¸</button>
    </p>
    <p>
        <button onclick="confirmCourses()">ç¢ºèªèª²ç¨‹</button>
    </p>
</div>

<!-- é–‹å§‹æŒ‰éˆ• -->
<div id="start-buttons">
    <p>é¸æ“‡æ¨¡å¼ï¼š</p>
    <button onclick="startGame(5,'en-to-zh')">è‹±æ–‡â†’ä¸­æ–‡</button>
    <button onclick="startGame(5,'zh-to-en')">ä¸­æ–‡â†’è‹±æ–‡</button>
</div>

<!-- æ¸¬é©—å€ -->
<div id="quiz-box">
    <h2 id="word">å–®å­—</h2>
    <div id="options"></div>
    <p id="score-box"></p>
    <button id="next-btn" onclick="nextQuestion()" style="display:none;">ä¸‹ä¸€é¡Œ</button>
</div>
</div>

<script>
// é¡Œåº«ç¯„ä¾‹
const quizData = [
  {word:'apple', answer:'è˜‹æœ', lesson:1},
  {word:'banana', answer:'é¦™è•‰', lesson:1},
  {word:'cat', answer:'è²“', lesson:2},
  {word:'dog', answer:'ç‹—', lesson:2},
  {word:'egg', answer:'è›‹', lesson:3},
  {word:'fish', answer:'é­š', lesson:3},
  {word:'grape', answer:'è‘¡è„', lesson:4},
  {word:'hat', answer:'å¸½å­', lesson:4},
  {word:'ice', answer:'å†°', lesson:5},
  {word:'juice', answer:'æœæ±', lesson:5},
  {word:'kite', answer:'é¢¨ç®', lesson:6},
  {word:'lion', answer:'ç…å­', lesson:6},
  {word:'moon', answer:'æœˆäº®', lesson:7},
  {word:'nest', answer:'é³¥å·¢', lesson:7},
  {word:'orange', answer:'æ©˜å­', lesson:8},
  {word:'pig', answer:'è±¬', lesson:8},
  {word:'queen', answer:'å¥³ç‹', lesson:9},
  {word:'rain', answer:'é›¨', lesson:9}
];

let selectedKid = null;
let selectedCourses = [];
let selectedQuestions = [];
let current = 0;
let score = 0;
let currentMode = 'en-to-zh';

// é¸å°å­©
function chooseKid(name, btn){
    selectedKid = name;
    selectedCourses = [];
    document.getElementById('role-select').style.display='none';
    document.getElementById('course-select').style.display='block';
    // é‡ç½®èª²ç¨‹æŒ‰éˆ•æ¨£å¼
    document.querySelectorAll('#course-buttons button').forEach(b=>b.classList.remove('selected'));
}

// å¤šé¸èª²ç¨‹
function toggleCourse(btn){
    const lesson = parseInt(btn.dataset.lesson);
    const index = selectedCourses.indexOf(lesson);
    if(index > -1){
        selectedCourses.splice(index,1);
        btn.classList.remove('selected');
    } else {
        selectedCourses.push(lesson);
        btn.classList.add('selected');
    }
}

// å…¨é¸èª²ç¨‹
function selectAllCourses(){
    selectedCourses = [1,2,3,4,5,6,7,8,9];
    document.querySelectorAll("#course-buttons button").forEach(btn => btn.classList.add("selected"));
}

// ç¢ºèªèª²ç¨‹
function confirmCourses(){
    if(selectedCourses.length===0){ alert("è«‹è‡³å°‘é¸ä¸€å€‹èª²ç¨‹"); return; }
    document.getElementById('course-select').style.display='none';
    document.getElementById('start-buttons').style.display='block';
}

// æ´—ç‰Œ
function shuffle(array){ return array.sort(()=>Math.random()-0.5); }

// é–‹å§‹æ¸¬é©—
function startGame(count, mode){
    if(!selectedKid){ alert("è«‹å…ˆé¸å°å­©"); return; }
    if(selectedCourses.length===0){ alert("è«‹å…ˆé¸èª²ç¨‹"); return; }

    currentMode = mode;
    current = 0;
    score = 0;
    // éæ¿¾æ‰€æœ‰é¸ä¸­çš„èª²ç¨‹
    const filteredQuestions = quizData.filter(q=> selectedCourses.includes(q.lesson));
    selectedQuestions = shuffle(filteredQuestions).slice(0,count);

    document.getElementById('start-buttons').style.display='none';
    document.getElementById('quiz-box').style.display='block';
    showQuestion();
}

// é¡¯ç¤ºé¡Œç›®
function showQuestion(){
    const data = selectedQuestions[current];
    const word = currentMode==='en-to-zh'?data.word:data.answer;
    const correct = currentMode==='en-to-zh'?data.answer:data.word;
    document.getElementById('word').textContent=word;

    if(currentMode==='en-to-zh'){
        const utterance=new SpeechSynthesisUtterance(data.word);
        utterance.lang='en-US';
        speechSynthesis.speak(utterance);
    }

    const optionsContainer=document.getElementById('options');
    optionsContainer.innerHTML='';

    const allChoices = quizData.map(q=>currentMode==='en-to-zh'?q.answer:q.word)
        .filter(ans=>ans!==correct);
    const wrongChoices = shuffle(allChoices).slice(0,3);
    const finalChoices = shuffle([correct,...wrongChoices]);

    finalChoices.forEach(choice=>{
        const btn=document.createElement('div');
        btn.className='option';
        btn.textContent=choice;
        btn.onclick=()=>checkAnswer(btn,choice,correct);
        optionsContainer.appendChild(btn);
    });

    document.getElementById('next-btn').style.display='none';
    document.getElementById('score-box').textContent=`ç¬¬ ${current+1} é¡Œ / å…± ${selectedQuestions.length} é¡Œ`;
}

// æª¢æŸ¥ç­”æ¡ˆ
function checkAnswer(button, choice, correct){
    const options=document.querySelectorAll('.option');
    options.forEach(opt=>{
        opt.onclick=null;
        if(opt.textContent===correct) opt.classList.add('correct');
        else if(opt.textContent===choice) opt.classList.add('wrong');
    });
    if(choice===correct) score++;
    document.getElementById('next-btn').style.display='inline-block';
}

// ä¸‹ä¸€é¡Œ
function nextQuestion(){
    current++;
    if(current<selectedQuestions.length) showQuestion();
    else showScore();
}

// é¡¯ç¤ºåˆ†æ•¸
function showScore(){
    document.getElementById('quiz-box').innerHTML=`
        <h2>${selectedKid} æ¸¬é©—å®Œæˆï¼</h2>
        <h3>å¾—åˆ†ï¼š${score} / ${selectedQuestions.length}</h3>
        <button onclick="location.reload()">å†ç©ä¸€æ¬¡ï¼Ÿ</button>
    `;
}
</script>

</body>
</html>
